{"ast":null,"code":"// src/utils/validation.ts\n\n/**\r\n * Validate that a setup object has all required ICC fields.\r\n */\nexport function isValidSetup(s) {\n  return !!(s && s.symbol && s.timeframe && Array.isArray(s.iccTags) && s.priceAtTrigger !== undefined && s.outcome && s.timeBlock && s.bot && s.timestamp);\n}\n\n/**\r\n * Normalize chart data into sorted, deduplicated { time, close } points.\r\n * Accepts either Unix timestamps or date strings.\r\n */\nexport function normalizeChartData(data) {\n  if (!Array.isArray(data)) return [];\n  const parsed = data.map(d => {\n    const t = typeof d.time === 'number' ? d.time : Math.floor(new Date(d.time).getTime() / 1000);\n    return {\n      time: t,\n      close: Number(d.close)\n    };\n  }).filter(d => Number.isFinite(d.time) && Number.isFinite(d.close)).sort((a, b) => a.time - b.time);\n\n  // Deduplicate by time\n  const out = [];\n  for (const p of parsed) {\n    if (!out.length || out[out.length - 1].time !== p.time) out.push(p);\n  }\n  return out;\n}","map":{"version":3,"names":["isValidSetup","s","symbol","timeframe","Array","isArray","iccTags","priceAtTrigger","undefined","outcome","timeBlock","bot","timestamp","normalizeChartData","data","parsed","map","d","t","time","Math","floor","Date","getTime","close","Number","filter","isFinite","sort","a","b","out","p","length","push"],"sources":["C:/Users/irajc/charting-platform/src/utils/validation.ts"],"sourcesContent":["// src/utils/validation.ts\r\nimport type { ICCSetup } from '../types/ICC';\r\n\r\n/**\r\n * Validate that a setup object has all required ICC fields.\r\n */\r\nexport function isValidSetup(s: Partial<ICCSetup>): s is ICCSetup {\r\n  return !!(\r\n    s &&\r\n    s.symbol &&\r\n    s.timeframe &&\r\n    Array.isArray(s.iccTags) &&\r\n    s.priceAtTrigger !== undefined &&\r\n    s.outcome &&\r\n    s.timeBlock &&\r\n    s.bot &&\r\n    s.timestamp\r\n  );\r\n}\r\n\r\n/**\r\n * Normalize chart data into sorted, deduplicated { time, close } points.\r\n * Accepts either Unix timestamps or date strings.\r\n */\r\nexport function normalizeChartData(\r\n  data: any[]\r\n): { time: number; close: number }[] {\r\n  if (!Array.isArray(data)) return [];\r\n  const parsed = data\r\n    .map(d => {\r\n      const t =\r\n        typeof d.time === 'number'\r\n          ? d.time\r\n          : Math.floor(new Date(d.time).getTime() / 1000);\r\n      return { time: t, close: Number(d.close) };\r\n    })\r\n    .filter(d => Number.isFinite(d.time) && Number.isFinite(d.close))\r\n    .sort((a, b) => a.time - b.time);\r\n\r\n  // Deduplicate by time\r\n  const out: { time: number; close: number }[] = [];\r\n  for (const p of parsed) {\r\n    if (!out.length || out[out.length - 1].time !== p.time) out.push(p);\r\n  }\r\n  return out;\r\n}"],"mappings":"AAAA;;AAGA;AACA;AACA;AACA,OAAO,SAASA,YAAYA,CAACC,CAAoB,EAAiB;EAChE,OAAO,CAAC,EACNA,CAAC,IACDA,CAAC,CAACC,MAAM,IACRD,CAAC,CAACE,SAAS,IACXC,KAAK,CAACC,OAAO,CAACJ,CAAC,CAACK,OAAO,CAAC,IACxBL,CAAC,CAACM,cAAc,KAAKC,SAAS,IAC9BP,CAAC,CAACQ,OAAO,IACTR,CAAC,CAACS,SAAS,IACXT,CAAC,CAACU,GAAG,IACLV,CAAC,CAACW,SAAS,CACZ;AACH;;AAEA;AACA;AACA;AACA;AACA,OAAO,SAASC,kBAAkBA,CAChCC,IAAW,EACwB;EACnC,IAAI,CAACV,KAAK,CAACC,OAAO,CAACS,IAAI,CAAC,EAAE,OAAO,EAAE;EACnC,MAAMC,MAAM,GAAGD,IAAI,CAChBE,GAAG,CAACC,CAAC,IAAI;IACR,MAAMC,CAAC,GACL,OAAOD,CAAC,CAACE,IAAI,KAAK,QAAQ,GACtBF,CAAC,CAACE,IAAI,GACNC,IAAI,CAACC,KAAK,CAAC,IAAIC,IAAI,CAACL,CAAC,CAACE,IAAI,CAAC,CAACI,OAAO,CAAC,CAAC,GAAG,IAAI,CAAC;IACnD,OAAO;MAAEJ,IAAI,EAAED,CAAC;MAAEM,KAAK,EAAEC,MAAM,CAACR,CAAC,CAACO,KAAK;IAAE,CAAC;EAC5C,CAAC,CAAC,CACDE,MAAM,CAACT,CAAC,IAAIQ,MAAM,CAACE,QAAQ,CAACV,CAAC,CAACE,IAAI,CAAC,IAAIM,MAAM,CAACE,QAAQ,CAACV,CAAC,CAACO,KAAK,CAAC,CAAC,CAChEI,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACV,IAAI,GAAGW,CAAC,CAACX,IAAI,CAAC;;EAElC;EACA,MAAMY,GAAsC,GAAG,EAAE;EACjD,KAAK,MAAMC,CAAC,IAAIjB,MAAM,EAAE;IACtB,IAAI,CAACgB,GAAG,CAACE,MAAM,IAAIF,GAAG,CAACA,GAAG,CAACE,MAAM,GAAG,CAAC,CAAC,CAACd,IAAI,KAAKa,CAAC,CAACb,IAAI,EAAEY,GAAG,CAACG,IAAI,CAACF,CAAC,CAAC;EACrE;EACA,OAAOD,GAAG;AACZ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}