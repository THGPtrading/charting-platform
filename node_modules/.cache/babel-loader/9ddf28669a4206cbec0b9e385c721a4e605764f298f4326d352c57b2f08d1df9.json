{"ast":null,"code":"useEffect(() => {\n  var _overlays;\n  if (!chartContainerRef.current) return;\n\n  // ✅ Do not call chartRef.current.remove() here\n  // React cleanup will handle disposal\n\n  const chart = createChart(chartContainerRef.current, {\n    width: chartContainerRef.current.clientWidth || 600,\n    height: 400,\n    layout: {\n      background: {\n        color: '#ffffff'\n      },\n      textColor: '#000'\n    },\n    grid: {\n      vertLines: {\n        color: '#eee'\n      },\n      horzLines: {\n        color: '#eee'\n      }\n    },\n    timeScale: {\n      timeVisible: true,\n      secondsVisible: true\n    }\n  });\n  const lineSeries = chart.addLineSeries();\n  const formattedData = data.map(d => ({\n    time: typeof d.time === 'number' ? d.time : Math.floor(new Date(d.time).getTime() / 1000),\n    value: d.value\n  }));\n  lineSeries.setData(formattedData);\n  if ((_overlays = overlays) !== null && _overlays !== void 0 && _overlays.triggers) {\n    lineSeries.setMarkers(overlays.triggers.map(trigger => ({\n      time: Math.floor(new Date(trigger.timestamp).getTime() / 1000),\n      position: 'aboveBar',\n      color: 'red',\n      shape: 'arrowUp',\n      text: trigger.iccTags.join(',')\n    })));\n  }\n  chartRef.current = chart;\n\n  // ✅ Cleanup: remove chart once\n  return () => {\n    chart.remove();\n    chartRef.current = null;\n  };\n}, [data, overlays]);","map":{"version":3,"names":["useEffect","_overlays","chartContainerRef","current","chart","createChart","width","clientWidth","height","layout","background","color","textColor","grid","vertLines","horzLines","timeScale","timeVisible","secondsVisible","lineSeries","addLineSeries","formattedData","data","map","d","time","Math","floor","Date","getTime","value","setData","overlays","triggers","setMarkers","trigger","timestamp","position","shape","text","iccTags","join","chartRef","remove"],"sources":["C:/Users/irajc/charting-platform/src/components/LightweightChart.tsx"],"sourcesContent":["useEffect(() => {\r\n  if (!chartContainerRef.current) return;\r\n\r\n  // ✅ Do not call chartRef.current.remove() here\r\n  // React cleanup will handle disposal\r\n\r\n  const chart = createChart(chartContainerRef.current, {\r\n    width: chartContainerRef.current.clientWidth || 600,\r\n    height: 400,\r\n    layout: { background: { color: '#ffffff' }, textColor: '#000' },\r\n    grid: { vertLines: { color: '#eee' }, horzLines: { color: '#eee' } },\r\n    timeScale: { timeVisible: true, secondsVisible: true },\r\n  });\r\n\r\n  const lineSeries = chart.addLineSeries();\r\n\r\n  const formattedData: LineData[] = data.map(d => ({\r\n    time:\r\n      typeof d.time === 'number'\r\n        ? (d.time as Time)\r\n        : (Math.floor(new Date(d.time).getTime() / 1000) as Time),\r\n    value: d.value,\r\n  }));\r\n  lineSeries.setData(formattedData);\r\n\r\n  if (overlays?.triggers) {\r\n    lineSeries.setMarkers(\r\n      overlays.triggers.map(trigger => ({\r\n        time: Math.floor(new Date(trigger.timestamp).getTime() / 1000) as Time,\r\n        position: 'aboveBar',\r\n        color: 'red',\r\n        shape: 'arrowUp',\r\n        text: trigger.iccTags.join(','),\r\n      }))\r\n    );\r\n  }\r\n\r\n  chartRef.current = chart;\r\n\r\n  // ✅ Cleanup: remove chart once\r\n  return () => {\r\n    chart.remove();\r\n    chartRef.current = null;\r\n  };\r\n}, [data, overlays]);"],"mappings":"AAAAA,SAAS,CAAC,MAAM;EAAA,IAAAC,SAAA;EACd,IAAI,CAACC,iBAAiB,CAACC,OAAO,EAAE;;EAEhC;EACA;;EAEA,MAAMC,KAAK,GAAGC,WAAW,CAACH,iBAAiB,CAACC,OAAO,EAAE;IACnDG,KAAK,EAAEJ,iBAAiB,CAACC,OAAO,CAACI,WAAW,IAAI,GAAG;IACnDC,MAAM,EAAE,GAAG;IACXC,MAAM,EAAE;MAAEC,UAAU,EAAE;QAAEC,KAAK,EAAE;MAAU,CAAC;MAAEC,SAAS,EAAE;IAAO,CAAC;IAC/DC,IAAI,EAAE;MAAEC,SAAS,EAAE;QAAEH,KAAK,EAAE;MAAO,CAAC;MAAEI,SAAS,EAAE;QAAEJ,KAAK,EAAE;MAAO;IAAE,CAAC;IACpEK,SAAS,EAAE;MAAEC,WAAW,EAAE,IAAI;MAAEC,cAAc,EAAE;IAAK;EACvD,CAAC,CAAC;EAEF,MAAMC,UAAU,GAAGf,KAAK,CAACgB,aAAa,CAAC,CAAC;EAExC,MAAMC,aAAyB,GAAGC,IAAI,CAACC,GAAG,CAACC,CAAC,KAAK;IAC/CC,IAAI,EACF,OAAOD,CAAC,CAACC,IAAI,KAAK,QAAQ,GACrBD,CAAC,CAACC,IAAI,GACNC,IAAI,CAACC,KAAK,CAAC,IAAIC,IAAI,CAACJ,CAAC,CAACC,IAAI,CAAC,CAACI,OAAO,CAAC,CAAC,GAAG,IAAI,CAAU;IAC7DC,KAAK,EAAEN,CAAC,CAACM;EACX,CAAC,CAAC,CAAC;EACHX,UAAU,CAACY,OAAO,CAACV,aAAa,CAAC;EAEjC,KAAApB,SAAA,GAAI+B,QAAQ,cAAA/B,SAAA,eAARA,SAAA,CAAUgC,QAAQ,EAAE;IACtBd,UAAU,CAACe,UAAU,CACnBF,QAAQ,CAACC,QAAQ,CAACV,GAAG,CAACY,OAAO,KAAK;MAChCV,IAAI,EAAEC,IAAI,CAACC,KAAK,CAAC,IAAIC,IAAI,CAACO,OAAO,CAACC,SAAS,CAAC,CAACP,OAAO,CAAC,CAAC,GAAG,IAAI,CAAS;MACtEQ,QAAQ,EAAE,UAAU;MACpB1B,KAAK,EAAE,KAAK;MACZ2B,KAAK,EAAE,SAAS;MAChBC,IAAI,EAAEJ,OAAO,CAACK,OAAO,CAACC,IAAI,CAAC,GAAG;IAChC,CAAC,CAAC,CACJ,CAAC;EACH;EAEAC,QAAQ,CAACvC,OAAO,GAAGC,KAAK;;EAExB;EACA,OAAO,MAAM;IACXA,KAAK,CAACuC,MAAM,CAAC,CAAC;IACdD,QAAQ,CAACvC,OAAO,GAAG,IAAI;EACzB,CAAC;AACH,CAAC,EAAE,CAACmB,IAAI,EAAEU,QAAQ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}