{"ast":null,"code":"// src/alerts/setupLogger.js\nimport { generateTags, getSessionTag } from './tagGenerator';\nimport { autoScoreSetup } from './scoringEngine';\nconst setupLog = [];\nconst dasTradeLog = [{\n  symbol: 'AAPL',\n  timestamp: '2025-11-11T09:32:00',\n  price: 186.42\n}, {\n  symbol: 'TSLA',\n  timestamp: '2025-11-11T10:15:00',\n  price: 238.90\n}];\nexport const logSetup = setup => {\n  const timestamp = new Date().toISOString();\n  const priceAtTrigger = setup.price || null;\n  const traded = dasTradeLog.some(trade => {\n    const setupTime = new Date(timestamp).getTime();\n    const tradeTime = new Date(trade.timestamp).getTime();\n    const timeDiff = Math.abs(tradeTime - setupTime);\n    return trade.symbol === setup.symbol && timeDiff <= 5 * 60 * 1000;\n  });\n  const scoring = autoScoreSetup({\n    ...setup,\n    traded,\n    priceAtTrigger\n  });\n  setupLog.push({\n    ...setup,\n    timestamp,\n    priceAtTrigger,\n    traded,\n    ...scoring,\n    tradervueTags: generateTags(setup)\n  });\n};\nexport const getSetupLog = () => setupLog;\nexport const exportSetupLogCSV = () => {\n  const headers = ['timestamp', 'symbol', 'source', 'dashboard', 'iccTags', 'tradervueTags', 'priceAtTrigger', 'traded', 'outcome', 'followThrough', 'maxGain', 'maxLoss'];\n  const rows = setupLog.map(setup => headers.map(key => {\n    const value = setup[key];\n    if (Array.isArray(value)) return `\"${value.join(',')}\"`;\n    return `\"${value !== null && value !== undefined ? value : ''}\"`;\n  }).join(','));\n  return [headers.join(','), ...rows].join('\\n');\n};","map":{"version":3,"names":["generateTags","getSessionTag","autoScoreSetup","setupLog","dasTradeLog","symbol","timestamp","price","logSetup","setup","Date","toISOString","priceAtTrigger","traded","some","trade","setupTime","getTime","tradeTime","timeDiff","Math","abs","scoring","push","tradervueTags","getSetupLog","exportSetupLogCSV","headers","rows","map","key","value","Array","isArray","join","undefined"],"sources":["C:/Users/irajc/charting-platform/src/alerts/setupLogger.js"],"sourcesContent":["// src/alerts/setupLogger.js\r\nimport { generateTags, getSessionTag } from './tagGenerator';\r\nimport { autoScoreSetup } from './scoringEngine';\r\n\r\nconst setupLog = [];\r\n\r\nconst dasTradeLog = [\r\n  { symbol: 'AAPL', timestamp: '2025-11-11T09:32:00', price: 186.42 },\r\n  { symbol: 'TSLA', timestamp: '2025-11-11T10:15:00', price: 238.90 },\r\n];\r\n\r\nexport const logSetup = (setup) => {\r\n  const timestamp = new Date().toISOString();\r\n  const priceAtTrigger = setup.price || null;\r\n\r\n  const traded = dasTradeLog.some((trade) => {\r\n    const setupTime = new Date(timestamp).getTime();\r\n    const tradeTime = new Date(trade.timestamp).getTime();\r\n    const timeDiff = Math.abs(tradeTime - setupTime);\r\n    return (\r\n      trade.symbol === setup.symbol &&\r\n      timeDiff <= 5 * 60 * 1000\r\n    );\r\n  });\r\n\r\n  const scoring = autoScoreSetup({ ...setup, traded, priceAtTrigger });\r\n\r\n  setupLog.push({\r\n    ...setup,\r\n    timestamp,\r\n    priceAtTrigger,\r\n    traded,\r\n    ...scoring,\r\n    tradervueTags: generateTags(setup),\r\n  });\r\n};\r\n\r\nexport const getSetupLog = () => setupLog;\r\n\r\nexport const exportSetupLogCSV = () => {\r\n  const headers = [\r\n    'timestamp',\r\n    'symbol',\r\n    'source',\r\n    'dashboard',\r\n    'iccTags',\r\n    'tradervueTags',\r\n    'priceAtTrigger',\r\n    'traded',\r\n    'outcome',\r\n    'followThrough',\r\n    'maxGain',\r\n    'maxLoss',\r\n  ];\r\n\r\n  const rows = setupLog.map((setup) =>\r\n    headers.map((key) => {\r\n      const value = setup[key];\r\n      if (Array.isArray(value)) return `\"${value.join(',')}\"`;\r\n      return `\"${value !== null && value !== undefined ? value : ''}\"`;\r\n    }).join(',')\r\n  );\r\n\r\n  return [headers.join(','), ...rows].join('\\n');\r\n};"],"mappings":"AAAA;AACA,SAASA,YAAY,EAAEC,aAAa,QAAQ,gBAAgB;AAC5D,SAASC,cAAc,QAAQ,iBAAiB;AAEhD,MAAMC,QAAQ,GAAG,EAAE;AAEnB,MAAMC,WAAW,GAAG,CAClB;EAAEC,MAAM,EAAE,MAAM;EAAEC,SAAS,EAAE,qBAAqB;EAAEC,KAAK,EAAE;AAAO,CAAC,EACnE;EAAEF,MAAM,EAAE,MAAM;EAAEC,SAAS,EAAE,qBAAqB;EAAEC,KAAK,EAAE;AAAO,CAAC,CACpE;AAED,OAAO,MAAMC,QAAQ,GAAIC,KAAK,IAAK;EACjC,MAAMH,SAAS,GAAG,IAAII,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;EAC1C,MAAMC,cAAc,GAAGH,KAAK,CAACF,KAAK,IAAI,IAAI;EAE1C,MAAMM,MAAM,GAAGT,WAAW,CAACU,IAAI,CAAEC,KAAK,IAAK;IACzC,MAAMC,SAAS,GAAG,IAAIN,IAAI,CAACJ,SAAS,CAAC,CAACW,OAAO,CAAC,CAAC;IAC/C,MAAMC,SAAS,GAAG,IAAIR,IAAI,CAACK,KAAK,CAACT,SAAS,CAAC,CAACW,OAAO,CAAC,CAAC;IACrD,MAAME,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAACH,SAAS,GAAGF,SAAS,CAAC;IAChD,OACED,KAAK,CAACV,MAAM,KAAKI,KAAK,CAACJ,MAAM,IAC7Bc,QAAQ,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI;EAE7B,CAAC,CAAC;EAEF,MAAMG,OAAO,GAAGpB,cAAc,CAAC;IAAE,GAAGO,KAAK;IAAEI,MAAM;IAAED;EAAe,CAAC,CAAC;EAEpET,QAAQ,CAACoB,IAAI,CAAC;IACZ,GAAGd,KAAK;IACRH,SAAS;IACTM,cAAc;IACdC,MAAM;IACN,GAAGS,OAAO;IACVE,aAAa,EAAExB,YAAY,CAACS,KAAK;EACnC,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMgB,WAAW,GAAGA,CAAA,KAAMtB,QAAQ;AAEzC,OAAO,MAAMuB,iBAAiB,GAAGA,CAAA,KAAM;EACrC,MAAMC,OAAO,GAAG,CACd,WAAW,EACX,QAAQ,EACR,QAAQ,EACR,WAAW,EACX,SAAS,EACT,eAAe,EACf,gBAAgB,EAChB,QAAQ,EACR,SAAS,EACT,eAAe,EACf,SAAS,EACT,SAAS,CACV;EAED,MAAMC,IAAI,GAAGzB,QAAQ,CAAC0B,GAAG,CAAEpB,KAAK,IAC9BkB,OAAO,CAACE,GAAG,CAAEC,GAAG,IAAK;IACnB,MAAMC,KAAK,GAAGtB,KAAK,CAACqB,GAAG,CAAC;IACxB,IAAIE,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE,OAAO,IAAIA,KAAK,CAACG,IAAI,CAAC,GAAG,CAAC,GAAG;IACvD,OAAO,IAAIH,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKI,SAAS,GAAGJ,KAAK,GAAG,EAAE,GAAG;EAClE,CAAC,CAAC,CAACG,IAAI,CAAC,GAAG,CACb,CAAC;EAED,OAAO,CAACP,OAAO,CAACO,IAAI,CAAC,GAAG,CAAC,EAAE,GAAGN,IAAI,CAAC,CAACM,IAAI,CAAC,IAAI,CAAC;AAChD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}