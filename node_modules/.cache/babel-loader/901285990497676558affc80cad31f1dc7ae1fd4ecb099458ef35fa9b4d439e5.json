{"ast":null,"code":"const setupLog = [];\n\n// Simulated DAS Pro trade log (replace with real integration later)\nconst dasTradeLog = [{\n  symbol: 'AAPL',\n  timestamp: '2025-11-11T09:32:00',\n  price: 186.42\n}, {\n  symbol: 'TSLA',\n  timestamp: '2025-11-11T10:15:00',\n  price: 238.90\n}];\nexport const logSetup = setup => {\n  const timestamp = new Date().toISOString();\n  const priceAtTrigger = setup.price || null;\n\n  // Auto-tag as traded if DAS Pro shows a trade within 5 mins of setup\n  const traded = dasTradeLog.some(trade => {\n    const setupTime = new Date(timestamp).getTime();\n    const tradeTime = new Date(trade.timestamp).getTime();\n    const timeDiff = Math.abs(tradeTime - setupTime);\n    return trade.symbol === setup.symbol && timeDiff <= 5 * 60 * 1000 // 5 minutes\n    ;\n  });\n  setupLog.push({\n    ...setup,\n    timestamp,\n    priceAtTrigger,\n    traded,\n    outcome: null,\n    // to be manually tagged later\n    followThrough: null,\n    // optional future scoring\n    maxGain: null,\n    maxLoss: null\n  });\n};\nexport const getSetupLog = () => {\n  return setupLog;\n};\n\n// Export to CSV\nexport const exportSetupLogCSV = () => {\n  const headers = ['timestamp', 'symbol', 'source', 'dashboard', 'iccTags', 'tradervueTags', 'priceAtTrigger', 'traded', 'outcome', 'followThrough', 'maxGain', 'maxLoss'];\n  const rows = setupLog.map(setup => headers.map(key => {\n    const value = setup[key];\n    if (Array.isArray(value)) return `\"${value.join(',')}\"`;\n    return `\"${value !== null && value !== undefined ? value : ''}\"`;\n  }).join(','));\n  return [headers.join(','), ...rows].join('\\n');\n};","map":{"version":3,"names":["setupLog","dasTradeLog","symbol","timestamp","price","logSetup","setup","Date","toISOString","priceAtTrigger","traded","some","trade","setupTime","getTime","tradeTime","timeDiff","Math","abs","push","outcome","followThrough","maxGain","maxLoss","getSetupLog","exportSetupLogCSV","headers","rows","map","key","value","Array","isArray","join","undefined"],"sources":["C:/Users/irajc/charting-platform/src/alerts/setupLogger.js"],"sourcesContent":["const setupLog = [];\r\n\r\n// Simulated DAS Pro trade log (replace with real integration later)\r\nconst dasTradeLog = [\r\n  { symbol: 'AAPL', timestamp: '2025-11-11T09:32:00', price: 186.42 },\r\n  { symbol: 'TSLA', timestamp: '2025-11-11T10:15:00', price: 238.90 },\r\n];\r\n\r\nexport const logSetup = (setup) => {\r\n  const timestamp = new Date().toISOString();\r\n  const priceAtTrigger = setup.price || null;\r\n\r\n  // Auto-tag as traded if DAS Pro shows a trade within 5 mins of setup\r\n  const traded = dasTradeLog.some((trade) => {\r\n    const setupTime = new Date(timestamp).getTime();\r\n    const tradeTime = new Date(trade.timestamp).getTime();\r\n    const timeDiff = Math.abs(tradeTime - setupTime);\r\n    return (\r\n      trade.symbol === setup.symbol &&\r\n      timeDiff <= 5 * 60 * 1000 // 5 minutes\r\n    );\r\n  });\r\n\r\n  setupLog.push({\r\n    ...setup,\r\n    timestamp,\r\n    priceAtTrigger,\r\n    traded,\r\n    outcome: null, // to be manually tagged later\r\n    followThrough: null, // optional future scoring\r\n    maxGain: null,\r\n    maxLoss: null,\r\n  });\r\n};\r\n\r\nexport const getSetupLog = () => {\r\n  return setupLog;\r\n};\r\n\r\n// Export to CSV\r\nexport const exportSetupLogCSV = () => {\r\n  const headers = [\r\n    'timestamp',\r\n    'symbol',\r\n    'source',\r\n    'dashboard',\r\n    'iccTags',\r\n    'tradervueTags',\r\n    'priceAtTrigger',\r\n    'traded',\r\n    'outcome',\r\n    'followThrough',\r\n    'maxGain',\r\n    'maxLoss',\r\n  ];\r\n\r\n  const rows = setupLog.map((setup) =>\r\n    headers.map((key) => {\r\n      const value = setup[key];\r\n      if (Array.isArray(value)) return `\"${value.join(',')}\"`;\r\n      return `\"${value !== null && value !== undefined ? value : ''}\"`;\r\n    }).join(',')\r\n  );\r\n\r\n  return [headers.join(','), ...rows].join('\\n');\r\n};\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAG,EAAE;;AAEnB;AACA,MAAMC,WAAW,GAAG,CAClB;EAAEC,MAAM,EAAE,MAAM;EAAEC,SAAS,EAAE,qBAAqB;EAAEC,KAAK,EAAE;AAAO,CAAC,EACnE;EAAEF,MAAM,EAAE,MAAM;EAAEC,SAAS,EAAE,qBAAqB;EAAEC,KAAK,EAAE;AAAO,CAAC,CACpE;AAED,OAAO,MAAMC,QAAQ,GAAIC,KAAK,IAAK;EACjC,MAAMH,SAAS,GAAG,IAAII,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;EAC1C,MAAMC,cAAc,GAAGH,KAAK,CAACF,KAAK,IAAI,IAAI;;EAE1C;EACA,MAAMM,MAAM,GAAGT,WAAW,CAACU,IAAI,CAAEC,KAAK,IAAK;IACzC,MAAMC,SAAS,GAAG,IAAIN,IAAI,CAACJ,SAAS,CAAC,CAACW,OAAO,CAAC,CAAC;IAC/C,MAAMC,SAAS,GAAG,IAAIR,IAAI,CAACK,KAAK,CAACT,SAAS,CAAC,CAACW,OAAO,CAAC,CAAC;IACrD,MAAME,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAACH,SAAS,GAAGF,SAAS,CAAC;IAChD,OACED,KAAK,CAACV,MAAM,KAAKI,KAAK,CAACJ,MAAM,IAC7Bc,QAAQ,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC;IAAA;EAE9B,CAAC,CAAC;EAEFhB,QAAQ,CAACmB,IAAI,CAAC;IACZ,GAAGb,KAAK;IACRH,SAAS;IACTM,cAAc;IACdC,MAAM;IACNU,OAAO,EAAE,IAAI;IAAE;IACfC,aAAa,EAAE,IAAI;IAAE;IACrBC,OAAO,EAAE,IAAI;IACbC,OAAO,EAAE;EACX,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMC,WAAW,GAAGA,CAAA,KAAM;EAC/B,OAAOxB,QAAQ;AACjB,CAAC;;AAED;AACA,OAAO,MAAMyB,iBAAiB,GAAGA,CAAA,KAAM;EACrC,MAAMC,OAAO,GAAG,CACd,WAAW,EACX,QAAQ,EACR,QAAQ,EACR,WAAW,EACX,SAAS,EACT,eAAe,EACf,gBAAgB,EAChB,QAAQ,EACR,SAAS,EACT,eAAe,EACf,SAAS,EACT,SAAS,CACV;EAED,MAAMC,IAAI,GAAG3B,QAAQ,CAAC4B,GAAG,CAAEtB,KAAK,IAC9BoB,OAAO,CAACE,GAAG,CAAEC,GAAG,IAAK;IACnB,MAAMC,KAAK,GAAGxB,KAAK,CAACuB,GAAG,CAAC;IACxB,IAAIE,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,EAAE,OAAO,IAAIA,KAAK,CAACG,IAAI,CAAC,GAAG,CAAC,GAAG;IACvD,OAAO,IAAIH,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAKI,SAAS,GAAGJ,KAAK,GAAG,EAAE,GAAG;EAClE,CAAC,CAAC,CAACG,IAAI,CAAC,GAAG,CACb,CAAC;EAED,OAAO,CAACP,OAAO,CAACO,IAAI,CAAC,GAAG,CAAC,EAAE,GAAGN,IAAI,CAAC,CAACM,IAAI,CAAC,IAAI,CAAC;AAChD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}